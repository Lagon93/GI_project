<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" href="styles.css">
        <meta name="viewport" content="width=device-width, initial-scale=1" />
 
    </head>
    <body onload="calculardeseos()">
 
        <div class="divFondo"></div>
        
        <div class="divContenido">
	        <!--Divs Gacha-->
            <div class="wishgif5" style="z-index: 9998; position: absolute; width: 100vw; height:100vh; background-color:black;"><video id="w5" muted src="img/5wish.webm" style=" margin:0px; width:100%; height:100%;"></video> </div>
            <div class="wishgif5pj" id="wishgif5pj" style="z-index: 9998; position: absolute; width: 100vw; height:100vh; background-color:black;"></div>
            <div><a class="wishgif5pjboton" onclick="volver()">Siguiente</a></div>
            <div class="wishgif4" style="z-index: 9998; position: absolute; width: 100vw; height:100vh; background-color:black;"><video id="w4" muted src="img/4wish.mp4" style=" margin:0px; width:100%; height:100%;"></video> </div>  
            <div class="wishgif4pj"  id="wishgif4pj" style="z-index: 9998; position: absolute; width: 100vw; height:100vh; background-color:black;"> </div> 
            <div><a class="wishgif5pjboton" onclick="volver()">Siguiente</a></div> 
            <div class="equipo" id="equipo" style="z-index: 9999; position: absolute; width: 100vw; height:100vh; background-color:rgba(0,0,0,0.99);"></div>
            <div><a class="equipo equipoboton" onclick="volver()">Volver</a></div> 

            <!--Divs Equipo-->
            <div class="Vacio"></div>
            <div class="Icono">
                <img class="Icono2" src="img/paimon1.webp"/>
            </div>
            <div class="Titulo">
                <span>Paimon</span><br/>
                <span class="Barra">&nbsp;</span>
            </div>
            <div class="Texto" id="Textodeseosfondo">
            <div class="Texto" id="Textodeseos">

                <a class="BotonD" onclick="deseo()">Deseo x 1 <br><span style="display: inline-flex;align-content: center;justify-content: center;flex-direction: row;align-items: center;"><img style="width: 10vw; height: 6vh; " src="./img/Item_Intertwined_Fate.webp"> <span id="x1">x</span></span></a>
                <a class="BotonE" onclick="equipo()">Equipo</a>
            </div></div>
    <script>     
    /* Funcion onload para calcular los deseos iniciales */
        function calculardeseos(){
        var deseos = 15;
        document.getElementById('x1').innerHTML = `x ${deseos}`;     
    }
        /* Inicializamos variables*/
        var Tier1 = ['albedo','arataki-itto','aloy','cyno', 'diluc', 'eula', 'ganyu', 'hu-tao', 'jean','kazuha', 'ayaka','ayato', 'keqing', 'klee', 'mona', 'nahida','nilou','qiqi','kokomi','shenhe','raiden','tartaglia','tighnari','wanderer','venti','xiao','yae-miko','yelan','yoimiya', 'zhongli']
        var Tier2 = ['amber','beidou','bennett','candace','chongyun','collei','diona','fischl','gorou','sara','kuki-shinobu','lisa','ningguang','noelle','razor','rosaria','sucrose','sayu','shikanoin-heizou','xiangling','xingqiu','xinyan','yanfei','yun-jin']
        var Team = ['albedo','arataki-itto','aloy','cyno', 'diluc', 'eula', 'ganyu', 'hu-tao', 'jean','kazuha', 'ayaka','ayato', 'keqing'];
        var wish = 0;
        var deseos = 15;
        const wish4 = new Audio();
        wish4.src = "./sounds/wish4star.mp3";
        const wish5 = new Audio();
        wish5.src = "./sounds/wish5star.mp3";

        /*funcion para volver a la primera pantalla*/
        function volver(){
            for(var elem of document.getElementsByClassName('wishgif5')){elem.style.display = 'none'};
            for(var elem of document.getElementsByClassName('wishgif5pj')){elem.style.display = 'none'};
            for(var elem of document.getElementsByClassName('wishgif4')){elem.style.display = 'none'};
            for(var elem of document.getElementsByClassName('wishgif4pj')){elem.style.display = 'none'};
            for(var elem of document.getElementsByClassName('wishgif5pjboton')){elem.style.display = 'none'};
            for(var elem of document.getElementsByClassName('equipo')){elem.style.display = 'none'};

        }
        /*Funcion de tirada del deseo*/
        function deseo(){
        if (deseos>0){
            wish=Math.floor(Math.random() * 11);
            if(wish>8){
                /*Tier 5*/
                let pj =Tier1[Math.floor(Math.random() * Tier1.length)];
                console.log(pj);
                Team.push(pj);
                for(var elem of document.getElementsByClassName('wishgif5')){elem.style.display = 'block'};
                document.getElementById('w5').play();
                wish5.play();
                document.getElementById('w5').onended=function(){
                    /*mostramos el personaje que ha tocado*/
                    for(var elem of document.getElementsByClassName('wishgif5pj')){elem.style.display = 'flex'};
                    for(var elem of document.getElementsByClassName('wishgif5pjboton')){elem.style.display = 'flex'};
                    document.getElementById('wishgif5pj').innerHTML = `<img id="personaje5" src="https://github.com/genshindev/api/blob/mistress/assets/images/characters/${pj}/gacha-splash?raw=true">`;
                    document.getElementById('personaje5').style.animationName = "deseopj"; 
                    document.getElementById('personaje5').style.animationDuration="3s";
                };
                console.log(Team);
            }else{
                /*Tier 4*/
                let pj =Tier2[Math.floor(Math.random() * Tier2.length)];
                console.log(pj);
                Team.push(pj);
                for(var elem of document.getElementsByClassName('wishgif4')){elem.style.display = 'block'};
                document.getElementById('w4').play();
                wish4.play();
                document.getElementById('w4').onended=function(){
                    /*mostramos el personaje que ha tocado*/
                    for(var elem of document.getElementsByClassName('wishgif4pj')){elem.style.display = 'flex'};
                    for(var elem of document.getElementsByClassName('wishgif5pjboton')){elem.style.display = 'flex'};
                    document.getElementById('wishgif4pj').innerHTML = `<img id="personaje4" src="https://github.com/genshindev/api/blob/mistress/assets/images/characters/${pj}/gacha-splash?raw=true">`;
                    document.getElementById('personaje4').style.animationName = "deseopj4"; 
                    document.getElementById('personaje4').style.animationDuration="3s";
                };console.log(Team);
            }
            console.log(wish);
            deseos=deseos-1;
            document.getElementById('x1').innerHTML = `x ${deseos}`;    
        }
    }
    function equipo(){
        for(var elem of document.getElementsByClassName('equipo')){elem.style.display = 'flex'};
        for(var elem of Team){
        document.getElementById('equipo').insertAdjacentHTML("beforeend",`<img class="pjequipo" src="https://github.com/genshindev/api/blob/mistress/assets/images/characters/${elem}/icon-side?raw=true">`) ;
        }
    }</script>
    </body>
</html>